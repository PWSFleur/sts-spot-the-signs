<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>STS – Conclusie</title>
  <style>
    :root{
      --bg:#f6f7f9; --card:#fff; --text:#111; --muted:#5b5b5b;
      --shadow:0 10px 28px rgba(0,0,0,.08);
      --radius:16px;
      --btn:#111; --btnText:#fff;
      --btn2:#e9ecef; --btn2Text:#111;
      --line:#e7e7e7;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);color:var(--text);line-height:1.6}
    .topbar{
      position:sticky; top:0; z-index:10;
      background:rgba(246,247,249,.92); backdrop-filter: blur(8px);
      border-bottom:1px solid var(--line);
    }
    .topbar-inner{max-width:980px;margin:0 auto;padding:10px 14px;display:flex;gap:10px;align-items:center;justify-content:space-between}
    .brand{font-weight:800}
    .navbtn{
      display:inline-block; padding:10px 12px; border-radius:12px;
      background:var(--btn2); color:var(--btn2Text); text-decoration:none; font-weight:700; font-size:14px;
    }
    .wrap{max-width:980px;margin:0 auto;padding:14px}
    .card{background:var(--card);border-radius:var(--radius);box-shadow:var(--shadow);padding:16px;margin:12px 0}
    h1{margin:0 0 6px;font-size:22px}
    .muted{color:var(--muted);font-size:14px;margin:0}
    .scorebox{
      margin-top:10px;
      display:flex; gap:10px; flex-wrap:wrap; align-items:center;
      padding:12px; border:1px solid var(--line); border-radius:14px; background:#fff;
    }
    .scorebig{font-weight:900;font-size:20px}
    .actions{display:flex;gap:10px;flex-wrap:wrap;margin-top:12px}
    .btn{
      display:block; flex:1; min-width:220px;
      text-align:center; padding:14px 16px; border-radius:14px;
      text-decoration:none; font-weight:800;
      background:var(--btn); color:var(--btnText);
    }
    .btn.secondary{background:var(--btn2); color:var(--btn2Text)}
    ul{margin:10px 0 0; padding-left:18px}
    @media (max-width:520px){
      .wrap{padding:12px}
      .card{padding:14px}
      .btn{min-width:100%}
    }
  </style>
</head>
<body>

<div class="topbar">
  <div class="topbar-inner">
    <div class="brand">STS – Spot the Signs</div>
    <a class="navbtn" href="index.html">Terug naar start</a>
  </div>
</div>

<main class="wrap">

  <section class="card">
    <h1>Conclusie</h1>
    <p class="muted" id="contextLine">Resultaat op basis van jouw antwoorden.</p>

    <div class="scorebox">
      <div class="scorebig" id="scoreBig">Score: —</div>
      <div class="muted" id="scoreMeta">—</div>
    </div>

    <div style="margin-top:12px" id="resultText"></div>

    <div class="actions">
      <a class="btn" id="backToList" href="index.html">Terug naar vragenlijst</a>
      <a class="btn secondary" href="index.html">Terug naar start</a>
    </div>
  </section>

  <section class="card">
    <h2 style="margin:0 0 10px;font-size:18px">Hulp en advies</h2>
    <ul>
      <li><strong>Bij direct gevaar:</strong> bel <strong>112</strong></li>
      <li><strong>Veilig Thuis:</strong> <a href="https://www.veiligthuis.nl" target="_blank" rel="noopener">www.veiligthuis.nl</a></li>
    </ul>
    <p class="muted" style="margin-top:10px">
      Let op: deze vragenlijst is geen diagnose en vervangt geen professioneel oordeel.
      Neem zorgen altijd serieus.
    </p>
  </section>

</main>

<script>
  function render(score, total, type){
    const scoreBig = document.getElementById("scoreBig");
    const scoreMeta = document.getElementById("scoreMeta");
    const resultText = document.getElementById("resultText");
    const contextLine = document.getElementById("contextLine");
    const backToList = document.getElementById("backToList");

    const label = (type === "dader") ? "Vragenlijst: eigen gedrag" : "Vragenlijst: signalering (iemand anders)";
    contextLine.textContent = label;

    backToList.href = (type === "dader") ? "dader.html" : "slachtoffer.html";

    scoreBig.textContent = "Score: " + score;
    scoreMeta.textContent = "Aantal JA-antwoorden (van " + total + " vragen).";

    let titel = "";
    let tekst = "";
    let advies = [];

    if (score <= 4) {
      titel = "Laag risiconiveau (0–4)";
      tekst = "Er zijn op dit moment geen sterke patronen zichtbaar die wijzen op dwingende controle. Blijf alert op veranderingen; één signaal kan al betekenisvol zijn.";
      advies = [
        "Blijf signalen serieus nemen en bespreek zorgen tijdig.",
        "Zoek steun bij iemand die je vertrouwt als je twijfelt."
      ];
    } else if (score <= 11) {
      titel = "Verhoogd risico (5–11)";
      tekst = "Meerdere signalen wijzen op mogelijke controle, manipulatie, psychische druk of isolatie. Dit zijn patronen die in de praktijk kunnen voorafgaan aan escalatie.";
      advies = [
        "Overweeg om met een professional of ervaringsdeskundige te spreken.",
        "Informeer jezelf over patronen van dwingende controle en grenzen."
      ];
    } else if (score <= 17) {
      titel = "Hoog risico (12–17)";
      tekst = "Er zijn duidelijke patronen aanwezig die passen bij ernstige controle of intieme terreur. Het risico kan in de tijd toenemen.";
      advies = [
        "Raadpleeg een professional voor persoonlijk advies.",
        "Neem contact op met organisaties die gespecialiseerd zijn in partnergeweld.",
        "Overweeg een veiligheidsplan als je je onveilig voelt."
      ];
    } else {
      titel = "Acuut / zeer hoog risico (18+)";
      tekst = "Dit is een alarmerende score. Combinaties van controle, dreiging, isolatie en manipulatie zijn ernstige waarschuwingssignalen.";
      advies = [
        "Zoek direct (desnoods anoniem) contact met een hulporganisatie.",
        "Deel je zorgen met iemand die je vertrouwt.",
        "Bij dreiging: wacht niet en bel 112."
      ];
    }

    resultText.innerHTML = `
      <h2 style="margin:0 0 8px;font-size:18px">${titel}</h2>
      <p style="margin:0 0 10px">${tekst}</p>
      <h3 style="margin:14px 0 8px;font-size:16px">Advies</h3>
      <ul style="margin:0; padding-left:18px">
        ${advies.map(a => `<li>${a}</li>`).join("")}
      </ul>
    `;
  }

  const raw = localStorage.getItem("stsResult");
  if (!raw) {
    document.getElementById("resultText").innerHTML =
      `<p><strong>Geen resultaat gevonden.</strong> Ga terug en vul eerst een vragenlijst in.</p>`;
    document.getElementById("scoreBig").textContent = "Score: —";
    document.getElementById("scoreMeta").textContent = "—";
  } else {
    try{
      const data = JSON.parse(raw);
      const score = Number(data.score);
      const total = Number(data.total);
      const type = data.type || "slachtoffer";
      if (Number.isFinite(score) && Number.isFinite(total)) {
        render(score, total, type);
      } else {
        throw new Error("Ongeldige data");
      }
    } catch(e){
      document.getElementById("resultText").innerHTML =
        `<p><strong>Resultaat kon niet worden gelezen.</strong> Vul de vragenlijst opnieuw in.</p>`;
    }
  }
</script>

</body>
</html>
